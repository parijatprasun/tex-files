% Remember to use the lgrind style

\Head{}
\File{.\,./dwt/recon.c}{2006}{5}{11}{11:59}{2185}
\L{\LB{\C{}/***********************************************************}}
\L{\LB{_*_File:_dwt/recon.c}}
\L{\LB{_*_Function:_recon}}
\L{\LB{_*_Purpose:_Receives_data_pointers_A_and_D;_three_integers_}}
\L{\LB{_*_n,_vanish_and_level_from_{`}main{'}._Selects_appropriate_}}
\L{\LB{_*_scaling_and_wavelet_numbers_depending_upon_the_values_}}
\L{\LB{_*_of_vanish_and_level._Then_finds_the_averaged_}}
\L{\LB{_*_and_detail_signals_by_reconstruction_from_the_trend_and}}
\L{\LB{_*_fluctuation_subsignals_using_those_numbers_and_stores_}}
\L{\LB{_*_them_in_A_and_D_respectively.}}
\L{\LB{_***********************************************************/\CE{}_}}
\L{\LB{}}
\L{\LB{\K{\#include}_\<\V{stdio}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{stdlib}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{math}.\V{h}\>}}
\L{\LB{}}
\index{recon}\Proc{recon}\L{\LB{\K{void}_\V{recon}(\K{double}_*\V{A},\K{double}_*\V{D},\K{int}_\V{n},\K{int}_\V{vanish},\K{int}_\V{level})}}
\L{\LB{\{}}
\L{\LB{}\Tab{4}{\K{double}_*\V{h};}\Tab{16}{\C{}/*_array_for_scaling_numbers_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{double}_*\V{g};}\Tab{16}{\C{}/*_array_for_wavelet_numbers_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{double}_*\V{ta},_*\V{td};_\C{}/*_arrays_for_temporary_storage_*/\CE{}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\K{int}_\V{i},\V{j},\V{k},\V{m};}\Tab{20}{\C{}/*_counters_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{support}=\N{2}*\V{vanish};_\C{}/*_no_of_time-unit_support_in_V_and_W_*/\CE{}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\C{}/***_allocate_memory_for_arrays_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{h}=(\K{double}_*)\V{calloc}(\V{support},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{\V{g}=(\K{double}_*)\V{calloc}(\V{support},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{ta}=(\K{double}_*)\V{calloc}(\V{n},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{\V{td}=(\K{double}_*)\V{calloc}(\V{n},\K{sizeof}(\K{double}));}}
\L{\LB{}}
\L{\LB{}\Tab{8}{\C{}/***_set_up_the_scaling_and_wavelet_numbers_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{switch}(\V{vanish})\{}}
\L{\LB{}\Tab{8}{\K{case}_\N{1}:}}
\L{\LB{}\Tab{12}{\V{db1}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{2}:}}
\L{\LB{}\Tab{12}{\V{db2}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{3}:}}
\L{\LB{}\Tab{12}{\V{db3}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{4}:}}
\L{\LB{}\Tab{12}{\V{db4}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{5}:}}
\L{\LB{}\Tab{12}{\V{db5}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{6}:}}
\L{\LB{}\Tab{12}{\V{db6}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{7}:}}
\L{\LB{}\Tab{12}{\V{db7}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{8}:}}
\L{\LB{}\Tab{12}{\V{db8}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{9}:}}
\L{\LB{}\Tab{12}{\V{db9}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{10}:}}
\L{\LB{}\Tab{12}{\V{db10}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{default}:}}
\L{\LB{}\Tab{12}{\V{fprintf}(\V{stderr},\S{}\3Sorry!_Operation_not_supported.\2n\3\SE{});}}
\L{\LB{}\Tab{12}{\V{exit}(\N{1});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_store_contents_of_A_and_D_before_clearing_them_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{i}=\N{0};\V{i}\<\V{n};\V{i}++)\{}}
\L{\LB{}\Tab{8}{\V{ta}[\V{i}]=\V{A}[\V{i}];}}
\L{\LB{}\Tab{8}{\V{td}[\V{i}]=\V{D}[\V{i}];}}
\L{\LB{}\Tab{8}{\V{A}[\V{i}]=\N{0.000};}}
\L{\LB{}\Tab{8}{\V{D}[\V{i}]=\N{0.000};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_reconstruction_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{m}=\V{level};\V{m}_\>=_\N{1};\V{m}\-\-)\{}}
\L{\LB{}\Tab{8}{\K{for}(\V{i}=\N{0};\V{i}\<\V{n};\V{i}++)\{}}
\L{\LB{}\Tab{12}{\V{A}[\V{i}]=\N{0.000};}}
\L{\LB{}\Tab{12}{\V{D}[\V{i}]=\N{0.000};}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{}\Tab{8}{\K{for}(\V{i}=\N{0},\V{j}=\N{0};\V{i}_\<_\V{n}/(\N{2}*\V{m});\V{j}+=\N{2},\V{i}++)\{}}
\L{\LB{}\Tab{12}{\K{for}(\V{k}=\N{0};\V{k}_\<_\V{support};\V{k}++)\{}}
\L{\LB{}\Tab{16}{\V{A}[(\V{j}+\V{k})\%(\V{n}/\V{m})]+=\V{h}[\V{k}]*\V{ta}[\V{i}];}}
\L{\LB{}\Tab{16}{\K{if}(\V{m}_==_\V{level})}}
\L{\LB{}\Tab{20}{\V{D}[(\V{j}+\V{k})\%(\V{n}/\V{m})]+=\V{g}[\V{k}]*\V{td}[\V{i}];}}
\L{\LB{}\Tab{16}{\K{else}}}
\L{\LB{}\Tab{20}{\V{D}[(\V{j}+\V{k})\%(\V{n}/\V{m})]+=\V{h}[\V{k}]*\V{td}[\V{i}];}}
\L{\LB{}\Tab{12}{\}}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{}\Tab{8}{\K{for}(\V{i}=\N{0};\V{i}\<\V{n};\V{i}++)\{}}
\L{\LB{}\Tab{12}{\V{ta}[\V{i}]=\V{A}[\V{i}];}}
\L{\LB{}\Tab{12}{\V{td}[\V{i}]=\V{D}[\V{i}];}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_free_allocated_memory_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{free}(\V{h});}}
\L{\LB{}\Tab{4}{\V{free}(\V{g});}}
\L{\LB{}\Tab{4}{\V{free}(\V{ta});}}
\L{\LB{}\Tab{4}{\V{free}(\V{td});}}
\L{\LB{\}}}
