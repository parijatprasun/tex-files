% Remember to use the lgrind style

\Head{}
\File{.\,./fft/main.c}{2006}{4}{29}{21:42}{2061}
\L{\LB{\C{}/********************************************************}}
\L{\LB{_*_File:_fft/main.c}}
\L{\LB{_*_Input_file(s):_1,_from_command_line}}
\L{\LB{_*_Output_file(s):_2,_append_{`}.fft{'}_and_{`}.abs{'}}}
\L{\LB{_*_Purpose:_Fast_Fourier_Transform}}
\L{\LB{_*_Algorithm:_Sande-Tuckey_(decimation-in-frequency)}}
\L{\LB{_*******************************************************/\CE{}}}
\L{\LB{}}
\L{\LB{\K{\#include}_\<\V{stdio}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{stdlib}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{string}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{math}.\V{h}\>}}
\L{\LB{\K{\#include}_\S{}\3fft.h\3\SE{}}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{\K{int}_\V{main}(\K{int}_\V{argc},_\K{char}_**\V{argv})}}
\L{\LB{\{}}
\L{\LB{}\Tab{4}{\V{FILE}_*\V{ip};}\Tab{16}{\C{}/*_input_file_pointer_*/\CE{}}}
\L{\LB{}\Tab{4}{\V{FILE}_*\V{op1};}\Tab{16}{\C{}/*_output_file_pointer_*/\CE{}}}
\L{\LB{}\Tab{4}{\V{FILE}_*\V{op2};}\Tab{16}{\C{}/*_another_output_file_pinter_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{int}_\V{c};}\Tab{16}{\C{}/*_counts_input_file_characters_*/\CE{}_}}
\L{\LB{}\Tab{4}{\K{int}_\V{N}=\N{0};}\Tab{16}{\C{}/*_number_of_points_(must_be_power_of_2)*/\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{i},\V{j},\V{k},\V{l};}\Tab{20}{\C{}/*_loop_indices_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{double}_*\V{f};}\Tab{16}{\C{}/*_data_as_read_in_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{double}_*\V{x};}\Tab{16}{\C{}/*_array_for_storing_input_data_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{double}_*\V{y};}\Tab{16}{\C{}/*_array_for_storing_result_*/\CE{}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{ip}=\V{fopen}(\V{argv}[\N{1}],\S{}\3r\3\SE{});}\Tab{28}{\C{}/*_file_containing_input_data_*/\CE{}}}
\L{\LB{}\Tab{4}{\V{op1}=\V{fopen}(\V{strcat}(\V{argv}[\N{1}],\S{}\3.fft\3\SE{}),\S{}\3w\3\SE{});}\Tab{44}{\C{}/*_stores_result_in_complex_form_*/\CE{}}}
\L{\LB{}\Tab{4}{\V{op2}=\V{fopen}(\V{strcat}(\V{argv}[\N{1}],\S{}\3.abs\3\SE{}),\S{}\3w\3\SE{});}\Tab{44}{\C{}/*_stores_result_in_amplitude-phase_form_*/\CE{}_}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\C{}/***_count_the_lines_of_the_input_file_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{while}((\V{c}=\V{fgetc}(\V{ip}))_!=_\V{EOF})\{}}
\L{\LB{}\Tab{8}{\K{if}(\V{c}_==_\S{}{'}\2n{'}\SE{})}}
\L{\LB{}\Tab{12}{++\V{N};}\Tab{20}{\C{}/*_stores_the_no_of_lines,_i.e._the_no_of_samples_*/\CE{}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{rewind}(\V{ip});}\Tab{16}{\C{}/*_back_to_starting_of_file_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_allocate_memory_for_the_arrays_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{f}=(\K{double}_*)\V{calloc}(\V{N},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{\V{x}=(\K{double}_*)\V{calloc}(\V{N},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{\V{y}=(\K{double}_*)\V{calloc}(\V{N},\K{sizeof}(\K{double}));}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_read_the_data_points_from_input_file_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{i}=\N{0};\V{i}_\<_\V{N};\V{i}++)}}
\L{\LB{}\Tab{8}{\V{fscanf}(\V{ip},\S{}\3\%lf\3\SE{},\&\V{f}[\V{i}]);}}
\L{\LB{}\Tab{4}{\C{}/***_copy_the_data_into_array_x_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{i}=\N{0};\V{i}_\<_\V{N};\V{i}++)}}
\L{\LB{}\Tab{8}{\V{x}[\V{i}]=\V{f}[\V{i}];}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{fclose}(\V{ip});}\Tab{16}{\C{}/*_close_the_input_file_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_FFT_operation:_decimation_in_frequency_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{fft}(\V{x},\V{y},\V{N});}\Tab{16}{\C{}/*_function_for_fft_*/\CE{}}}
\L{\LB{}\Tab{4}{\V{bitrev}(\V{x},\V{y},\V{N});}\Tab{24}{\C{}/*_function_for_bit_reversal_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_print_results_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{i}=\N{0};\V{i}_\<_\V{N};\V{i}++)\{}}
\L{\LB{}\Tab{8}{\V{fprintf}(\V{op1},\S{}\3\%d\2t\%f\2t\%f\2n\3\SE{},\V{i},\V{x}[\V{i}],\V{y}[\V{i}]);}}
\L{\LB{}\Tab{8}{\V{fprintf}(\V{op2},\S{}\3\%d\2t\%f\2t\%f\2n\3\SE{},\V{i},\V{sqrt}(\V{pow}(\V{x}[\V{i}],\N{2})+\V{pow}(\V{y}[\V{i}],\N{2})),}}
\L{\LB{}\Tab{16}{\V{atan2}(\V{y}[\V{i}],\V{x}[\V{i}]));}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_free_allocated_memory_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{free}(\V{f});}}
\L{\LB{}\Tab{4}{\V{free}(\V{x});}}
\L{\LB{}\Tab{4}{\V{free}(\V{y});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_close_the_output_files_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{fclose}(\V{op1});}}
\L{\LB{}\Tab{4}{\V{fclose}(\V{op2});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{return}_\N{0};}}
\L{\LB{\}}}
