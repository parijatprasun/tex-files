% Remember to use the lgrind style

\Head{}
\File{.\,./dwt/dwt.c}{2006}{5}{11}{11:57}{2053}
\L{\LB{\C{}/***********************************************************}}
\L{\LB{_*_File:_dwt/dwt.c}}
\L{\LB{_*_Function:_dwt}}
\L{\LB{_*_Purpose:_Receives_three_data_pointers_a_and_d;_three}}
\L{\LB{_*_integers_n,_vanish_and_level_from_{`}main{'}._Selects_the_}}
\L{\LB{_*_appropriate_scaling_and_wavelet_numbers_depending_upon_}}
\L{\LB{_*_the_values_of_vanish_and_level._Then_finds_the_trend_and}}
\L{\LB{_*_fluctuation_subsignals_using_those_numbers_and_stores_}}
\L{\LB{_*_them_in_a_and_d_respectively.}}
\L{\LB{_***********************************************************/\CE{}_}}
\L{\LB{}}
\L{\LB{\K{\#include}_\<\V{stdio}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{stdlib}.\V{h}\>}}
\L{\LB{}}
\index{dwt}\Proc{dwt}\L{\LB{\K{void}_\V{dwt}(\K{double}_*\V{a},\K{double}_*\V{d},\K{int}_\V{n},\K{int}_\V{vanish},\K{int}_\V{level})}}
\L{\LB{\{}}
\L{\LB{}\Tab{4}{\K{double}_*\V{h};}\Tab{16}{\C{}/*_array_for_scaling_numbers_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{double}_*\V{g};}\Tab{16}{\C{}/*_array_for_wavelet_numbers_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{double}_*\V{ta};}\Tab{16}{\C{}/*_array_for_temporary_storage_*/\CE{}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\K{int}_\V{i},\V{j},\V{k},\V{m};}\Tab{20}{\C{}/*_counters_*/\CE{}}}
\L{\LB{}\Tab{4}{\K{int}_\V{support}=\N{2}*\V{vanish};}\Tab{28}{\C{}/*_number_of_time-unit_supports_}}
\L{\LB{}\Tab{19}{in_scaling_signals_and_wavelets_*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_allocate_memory_for_arrays_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{h}=(\K{double}_*)\V{calloc}(\V{support},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{\V{g}=(\K{double}_*)\V{calloc}(\V{support},\K{sizeof}(\K{double}));}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{ta}=(\K{double}_*)\V{calloc}(\V{n},\K{sizeof}(\K{double}));}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\C{}/***_set_up_the_scaling_and_wavelets_numbers_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{switch}(\V{vanish})\{}}
\L{\LB{}\Tab{8}{\K{case}_\N{1}:}}
\L{\LB{}\Tab{12}{\V{db1}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{2}:}}
\L{\LB{}\Tab{12}{\V{db2}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{3}:}}
\L{\LB{}\Tab{12}{\V{db3}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{4}:}}
\L{\LB{}\Tab{12}{\V{db4}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{5}:}}
\L{\LB{}\Tab{12}{\V{db5}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{6}:}}
\L{\LB{}\Tab{12}{\V{db6}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{7}:}}
\L{\LB{}\Tab{12}{\V{db7}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{8}:}}
\L{\LB{}\Tab{12}{\V{db8}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{9}:}}
\L{\LB{}\Tab{12}{\V{db9}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{case}_\N{10}:}}
\L{\LB{}\Tab{12}{\V{db10}(\V{h},\V{g});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{8}{\K{default}:}}
\L{\LB{}\Tab{12}{\V{fprintf}(\V{stderr},\S{}\3Sorry!_Operation_not_supported.\2n\3\SE{});}}
\L{\LB{}\Tab{12}{\V{exit}(\N{1});}}
\L{\LB{}\Tab{12}{\K{break};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_store_the_starting_values_of_a_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{i}=\N{0};\V{i}\<\V{n};\V{i}++)}}
\L{\LB{}\Tab{8}{\V{ta}[\V{i}]=\V{a}[\V{i}];}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/***_find_trend_and_fluctuation_of_each_level_***/\CE{}}}
\L{\LB{}\Tab{4}{\K{for}(\V{m}=\N{1};\V{m}_\<=_\V{level};\V{m}++)\{}}
\L{\LB{}\Tab{8}{\K{for}(\V{i}=\N{0},\V{j}=\N{0};\V{i}_\<_\V{n}/(\N{2}*\V{m});\V{j}+=\N{2},\V{i}++)\{}}
\L{\LB{}\Tab{12}{\V{a}[\V{i}]=\V{h}[\N{0}]*\V{ta}[\V{j}\%(\V{n}/\V{m})];_\C{}/*_first_trend_element_*/\CE{}}}
\L{\LB{}\Tab{12}{\V{d}[\V{i}]=\V{g}[\N{0}]*\V{ta}[\V{j}\%(\V{n}/\V{m})];_\C{}/*_first_fluctuation_element_*/\CE{}}}
\L{\LB{}\Tab{12}{\K{for}(\V{k}=\N{1};\V{k}_\<_\V{support};\V{k}++)\{}}
\L{\LB{}\Tab{16}{\V{a}[\V{i}]+=\V{h}[\V{k}]*\V{ta}[(\V{j}+\V{k})\%(\V{n}/\V{m})];_}}
\L{\LB{}\Tab{16}{\V{d}[\V{i}]+=\V{g}[\V{k}]*\V{ta}[(\V{j}+\V{k})\%(\V{n}/\V{m})];}}
\L{\LB{}\Tab{12}{\}}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{}\Tab{8}{\K{for}(\V{i}=\N{0};\V{i}\<\V{n};\V{i}++)}}
\L{\LB{}\Tab{12}{\V{ta}[\V{i}]=\V{a}[\V{i}];_\C{}/*_store_for_next_level_*/\CE{}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\C{}/***_free_the_allocated_memory_***/\CE{}}}
\L{\LB{}\Tab{4}{\V{free}(\V{h});}}
\L{\LB{}\Tab{4}{\V{free}(\V{g});}}
\L{\LB{}\Tab{4}{\V{free}(\V{ta});}}
\L{\LB{\}}}
